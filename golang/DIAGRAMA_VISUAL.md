# ğŸ¨ Diagramas Visuais da Arquitetura

## ğŸ“Š Arquitetura em Camadas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENTE HTTP                          â”‚
â”‚              (Browser, Postman, curl, etc.)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Request
                         â”‚ GET /api/v1/estados/SP
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMADA DE ROTEAMENTO                      â”‚
â”‚                      (gorilla/mux)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Router                                             â”‚     â”‚
â”‚  â”‚  - Recebe requisiÃ§Ã£o                               â”‚     â”‚
â”‚  â”‚  - Identifica rota                                 â”‚     â”‚
â”‚  â”‚  - Executa middlewares                             â”‚     â”‚
â”‚  â”‚  - Chama handler apropriado                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CAMADA DE APRESENTAÃ‡ÃƒO (Handler)                â”‚
â”‚                  internal/handler/                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  EstadoHandler                                      â”‚     â”‚
â”‚  â”‚  âœ“ Extrai parÃ¢metros (uf = "SP")                  â”‚     â”‚
â”‚  â”‚  âœ“ Valida entrada bÃ¡sica                          â”‚     â”‚
â”‚  â”‚  âœ“ Chama service.GetEstadoByUF("SP")              â”‚     â”‚
â”‚  â”‚  âœ“ Formata resposta HTTP                          â”‚     â”‚
â”‚  â”‚  âœ“ Define status code                             â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            CAMADA DE LÃ“GICA DE NEGÃ“CIO (Service)             â”‚
â”‚                  internal/service/                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  EstadoService                                      â”‚     â”‚
â”‚  â”‚  âœ“ Valida regras de negÃ³cio (len(uf) == 2)        â”‚     â”‚
â”‚  â”‚  âœ“ Normaliza dados (ToUpper)                      â”‚     â”‚
â”‚  â”‚  âœ“ Aplica lÃ³gica de negÃ³cio                       â”‚     â”‚
â”‚  â”‚  âœ“ Chama client.GetEstadoByUF("SP")               â”‚     â”‚
â”‚  â”‚  âœ“ Transforma dados se necessÃ¡rio                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CAMADA DE ACESSO A DADOS (Client)                   â”‚
â”‚                  internal/client/                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  IBGEClient                                         â”‚     â”‚
â”‚  â”‚  âœ“ Monta URL da API                                â”‚     â”‚
â”‚  â”‚  âœ“ Faz requisiÃ§Ã£o HTTP GET                         â”‚     â”‚
â”‚  â”‚  âœ“ Trata erros de rede                             â”‚     â”‚
â”‚  â”‚  âœ“ Deserializa JSON â†’ struct Estado                â”‚     â”‚
â”‚  â”‚  âœ“ Retorna dados                                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Request
                         â”‚ GET https://servicodados.ibge.gov.br/
                         â”‚     api/v1/localidades/estados/SP
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API EXTERNA (IBGE)                      â”‚
â”‚                                                              â”‚
â”‚  Retorna JSON:                                               â”‚
â”‚  {                                                           â”‚
â”‚    "id": 35,                                                 â”‚
â”‚    "sigla": "SP",                                            â”‚
â”‚    "nome": "SÃ£o Paulo"                                       â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Resposta volta pelo mesmo caminho
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESPOSTA AO CLIENTE                       â”‚
â”‚                                                              â”‚
â”‚  HTTP/1.1 200 OK                                             â”‚
â”‚  Content-Type: application/json                              â”‚
â”‚                                                              â”‚
â”‚  {                                                           â”‚
â”‚    "success": true,                                          â”‚
â”‚    "data": {                                                 â”‚
â”‚      "id": 35,                                               â”‚
â”‚      "sigla": "SP",                                          â”‚
â”‚      "nome": "SÃ£o Paulo"                                     â”‚
â”‚    }                                                         â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Fluxo de Dados Detalhado

### RequisiÃ§Ã£o: GET /api/v1/estados/SP

```
1. CLIENTE
   â””â”€â†’ Envia: GET /api/v1/estados/SP

2. ROUTER (main.go)
   â””â”€â†’ Middleware de Logging
       â””â”€â†’ Log: "GET /api/v1/estados/SP 127.0.0.1"
   â””â”€â†’ Identifica rota: /api/v1/estados/{uf}
   â””â”€â†’ Chama: estadoHandler.GetEstadoByUF()

3. HANDLER (estado_handler.go)
   â””â”€â†’ Extrai: uf = "SP" (usando mux.Vars)
   â””â”€â†’ Log: "GET /api/v1/estados/SP - Buscando estado"
   â””â”€â†’ Chama: service.GetEstadoByUF("SP")

4. SERVICE (estado_service.go)
   â””â”€â†’ Valida: len("SP") == 2 âœ“
   â””â”€â†’ Normaliza: "SP" â†’ "SP" (jÃ¡ maiÃºsculo)
   â””â”€â†’ Chama: client.GetEstadoByUF("SP")

5. CLIENT (ibge_client.go)
   â””â”€â†’ Monta URL: "https://servicodados.ibge.gov.br/api/v1/localidades/estados/SP"
   â””â”€â†’ HTTP GET com timeout de 10s
   â””â”€â†’ Recebe JSON da API IBGE
   â””â”€â†’ Deserializa: JSON â†’ Estado struct
   â””â”€â†’ Retorna: &Estado{ID: 35, Sigla: "SP", Nome: "SÃ£o Paulo"}

6. SERVICE (volta)
   â””â”€â†’ Recebe estado do client
   â””â”€â†’ Retorna para handler

7. HANDLER (volta)
   â””â”€â†’ Recebe estado do service
   â””â”€â†’ Chama: response.JSON(w, 200, estado)

8. RESPONSE (response.go)
   â””â”€â†’ Cria Response struct
   â””â”€â†’ Serializa para JSON
   â””â”€â†’ Define headers HTTP
   â””â”€â†’ Envia resposta

9. CLIENTE
   â””â”€â†’ Recebe: 200 OK + JSON
```

## ğŸ¢ Estrutura de DependÃªncias

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ main.go  â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ config â”‚    â”‚ handler  â”‚    â”‚response â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ service  â”‚
                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  client  â”‚
                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  model   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ OrganizaÃ§Ã£o de Packages

```
github.com/seu-usuario/ibge-api
â”‚
â”œâ”€ cmd/api                          (package main)
â”‚  â””â”€ ExecutÃ¡vel da aplicaÃ§Ã£o
â”‚
â”œâ”€ internal/                        (privado)
â”‚  â”œâ”€ config                        (package config)
â”‚  â”œâ”€ handler                       (package handler)
â”‚  â”œâ”€ service                       (package service)
â”‚  â”œâ”€ client                        (package client)
â”‚  â””â”€ model                         (package model)
â”‚
â””â”€ pkg/                             (pÃºblico)
   â””â”€ response                      (package response)
```

## ğŸ¯ Responsabilidades por Camada

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HANDLER                                                  â”‚
â”‚ âœ“ HTTP Request/Response                                 â”‚
â”‚ âœ“ ExtraÃ§Ã£o de parÃ¢metros                               â”‚
â”‚ âœ“ ValidaÃ§Ã£o bÃ¡sica de entrada                          â”‚
â”‚ âœ“ Status codes HTTP                                     â”‚
â”‚ âœ— LÃ³gica de negÃ³cio                                    â”‚
â”‚ âœ— Acesso a dados                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SERVICE                                                  â”‚
â”‚ âœ“ LÃ³gica de negÃ³cio                                    â”‚
â”‚ âœ“ ValidaÃ§Ã£o de regras                                  â”‚
â”‚ âœ“ OrquestraÃ§Ã£o de operaÃ§Ãµes                            â”‚
â”‚ âœ“ TransformaÃ§Ã£o de dados                               â”‚
â”‚ âœ— Conhecimento de HTTP                                 â”‚
â”‚ âœ— Acesso direto a APIs                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLIENT                                                   â”‚
â”‚ âœ“ RequisiÃ§Ãµes HTTP                                      â”‚
â”‚ âœ“ SerializaÃ§Ã£o/DeserializaÃ§Ã£o                          â”‚
â”‚ âœ“ Tratamento de erros de rede                          â”‚
â”‚ âœ“ Timeouts e retries                                   â”‚
â”‚ âœ— LÃ³gica de negÃ³cio                                    â”‚
â”‚ âœ— ValidaÃ§Ã£o de regras                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª Testabilidade

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TESTE DE HANDLER                                         â”‚
â”‚                                                          â”‚
â”‚  Handler â”€â”€â†’ Mock Service                               â”‚
â”‚                                                          â”‚
â”‚  Testa:                                                  â”‚
â”‚  â€¢ ExtraÃ§Ã£o de parÃ¢metros                              â”‚
â”‚  â€¢ FormataÃ§Ã£o de resposta                              â”‚
â”‚  â€¢ Status codes                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TESTE DE SERVICE                                         â”‚
â”‚                                                          â”‚
â”‚  Service â”€â”€â†’ Mock Client                                â”‚
â”‚                                                          â”‚
â”‚  Testa:                                                  â”‚
â”‚  â€¢ ValidaÃ§Ãµes de negÃ³cio                               â”‚
â”‚  â€¢ TransformaÃ§Ãµes de dados                             â”‚
â”‚  â€¢ OrquestraÃ§Ã£o de operaÃ§Ãµes                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TESTE DE CLIENT                                          â”‚
â”‚                                                          â”‚
â”‚  Client â”€â”€â†’ HTTP Test Server                            â”‚
â”‚                                                          â”‚
â”‚  Testa:                                                  â”‚
â”‚  â€¢ RequisiÃ§Ãµes HTTP                                     â”‚
â”‚  â€¢ Tratamento de erros                                  â”‚
â”‚  â€¢ DeserializaÃ§Ã£o                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” PrincÃ­pios SOLID Aplicados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ S - Single Responsibility Principle                      â”‚
â”‚ Cada camada tem UMA responsabilidade                    â”‚
â”‚                                                          â”‚
â”‚ Handler  â†’ HTTP                                          â”‚
â”‚ Service  â†’ NegÃ³cio                                       â”‚
â”‚ Client   â†’ Dados                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ O - Open/Closed Principle                               â”‚
â”‚ Aberto para extensÃ£o, fechado para modificaÃ§Ã£o          â”‚
â”‚                                                          â”‚
â”‚ Adicionar novo endpoint: cria novo handler              â”‚
â”‚ NÃ£o modifica handlers existentes                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L - Liskov Substitution Principle                       â”‚
â”‚ Interfaces podem ser substituÃ­das                       â”‚
â”‚                                                          â”‚
â”‚ IBGEClient interface                                     â”‚
â”‚ â”œâ”€ ibgeClient (produÃ§Ã£o)                               â”‚
â”‚ â””â”€ mockIBGEClient (testes)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ I - Interface Segregation Principle                     â”‚
â”‚ Interfaces especÃ­ficas e focadas                        â”‚
â”‚                                                          â”‚
â”‚ IBGEClient: apenas mÃ©todos necessÃ¡rios                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ D - Dependency Inversion Principle                      â”‚
â”‚ Depende de abstraÃ§Ãµes, nÃ£o de implementaÃ§Ãµes            â”‚
â”‚                                                          â”‚
â”‚ Service depende de IBGEClient (interface)               â”‚
â”‚ NÃ£o depende de ibgeClient (implementaÃ§Ã£o)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Escalabilidade

### Adicionar Cache

```
Handler
   â”‚
   â–¼
Service
   â”‚
   â”œâ”€â†’ Cache? â”€â”€â†’ Retorna
   â”‚      â”‚
   â”‚      âœ— (miss)
   â”‚      â–¼
   â””â”€â†’ Client â”€â”€â†’ Salva no Cache â”€â”€â†’ Retorna
```

### Adicionar Banco de Dados

```
Handler
   â”‚
   â–¼
Service
   â”‚
   â”œâ”€â†’ Database Client (dados locais)
   â”‚
   â””â”€â†’ IBGE Client (dados externos)
```

### Adicionar AutenticaÃ§Ã£o

```
Request
   â”‚
   â–¼
Auth Middleware â”€â”€â†’ Valida Token
   â”‚                     â”‚
   â”‚                     âœ— (invÃ¡lido)
   â”‚                     â””â”€â†’ 401 Unauthorized
   â”‚
   âœ“ (vÃ¡lido)
   â”‚
   â–¼
Handler
```

## ğŸ“Š ComparaÃ§Ã£o: Antes vs Depois

### âŒ CÃ³digo MonolÃ­tico (Ruim)

```go
func main() {
    http.HandleFunc("/estados", func(w http.ResponseWriter, r *http.Request) {
        // Tudo misturado!
        resp, _ := http.Get("https://api.ibge.gov.br/...")
        body, _ := io.ReadAll(resp.Body)
        w.Write(body)
    })
}
```

**Problemas:**
- ImpossÃ­vel testar
- DifÃ­cil de manter
- Sem separaÃ§Ã£o de responsabilidades
- CÃ³digo duplicado

### âœ… CÃ³digo Profissional (Bom)

```go
// Separado em camadas
Handler â†’ Service â†’ Client

// TestÃ¡vel
// ManutenÃ­vel
// EscalÃ¡vel
// ReutilizÃ¡vel
```

---

**Este Ã© o padrÃ£o usado por empresas de tecnologia lÃ­deres mundiais!** ğŸŒŸ
